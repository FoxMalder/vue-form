/*!
 * vue-form v0.1.0
 * Released under the MIT License.
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.VueForm=e()}(this,function(){"use strict";function t(t){N=t.util,T=t.config.debug||!t.config.silent}function e(t){"undefined"!=typeof console&&T&&console.warn("[VueForm warn]: "+t)}function n(t){return"string"==typeof t}function i(t){return null!==t&&"object"===("undefined"==typeof t?"undefined":j(t))}function o(t){return"undefined"==typeof t}function a(t,e,n,i){t.addEventListener(e,n,i)}function r(t,e,n,i){t.removeEventListener(e,n,i)}function l(t,e){return t?t.getAttribute(e):null}function s(t,e){var n=document.createEvent("HTMLEvents");n.initEvent(e,!0,!1),t.dispatchEvent(n)}function u(t){return N.camelize(t)}function d(t,e){t.splice(t.indexOf(e),1)}function f(t,e){var n,o;if("number"==typeof t.length)for(n=0;n<t.length;n++)e.call(t[n],t[n],n);else if(i(t))for(o in t)t.hasOwnProperty(o)&&e.call(t[o],t[o],o);return t}function p(t){return{name:"fields",template:L,props:{config:{default:""},values:{type:Object},template:{type:String}},created:function(){var o=this.$options,a=o.types,r=o.templates,l=o.components;if(!this.config||!this.values)return e("Invalid config or model provided"),void(this.$options.template="");this.template&&this.template in r&&(this.$options.template=r[this.template]);for(var s in a){var u=a[s];n(u)?u=t.extend({extends:F,template:u}):i(u)&&(u=t.extend(F).extend(u)),l[s]=u}},computed:{fields:function i(){var o=this,a=V(this.config),i=[];return f(this.config,function(r,l){n(r.name)||a||(r.name=l),n(r.type)&&r.type in o.$options.types||(r.type="text"),n(r.name)?r.show&&!new t({data:o.values}).$eval(r.show)||i.push(r):e("Field name missing "+JSON.stringify(r))}),i}},methods:{get:function(t){return this.$get("values"+t.key)},set:function(t,e){this.$set("values"+t.key,e)}},types:{text:'<input type="text" v-bind="attrs" v-model="value">',textarea:'<textarea v-bind="attrs" v-model="value"></textarea>',radio:'<template v-for="option in options | options">\n                    <input type="radio" v-bind="attrs" :name="name" :value="option.value" v-model="value"> <label>{{ option.text }}</label>\n                 </template>',checkbox:'<input type="checkbox" v-bind="attrs" v-model="value">',select:'<select v-bind="attrs" v-model="value">\n                     <template v-for="option in options | options">\n                         <optgroup :label="option.label" v-if="option.label">\n                             <option v-for="opt in option.options" :value="opt.value">{{ opt.text }}</option>\n                         </optgroup>\n                         <option :value="option.value" v-else>{{ option.text }}</option>\n                     </template>\n                 </select>',range:'<input type="range" v-bind="attrs" v-model="value">',number:'<input type="number" v-bind="attrs" v-model="value">'},templates:{},components:{}}}function c(t,e){return"boolean"!=typeof e&&(e=!0),"boolean"==typeof t?!e||t:!e||!(null===t||0===t.length)}function v(t){return/^[-+]?[0-9]+$/.test(t)}function h(t){return/^(?:[-+]?(?:0|[1-9][0-9]*))$/.test(t)}function m(t){return/^(?:[-+]?(?:[0-9]+))?(?:\.[0-9]*)?(?:[eE][\+\-]?(?:[0-9]+))?$/.test(t)}function y(t){return/^([A-Z]+)?$/i.test(t)}function g(t){return/^([0-9A-Z]+)?$/i.test(t)}function b(t){return/^([a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*)?$/i.test(t||"a@a.aa")}function x(t){return/^((ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?)?$/.test(t)}function $(t,e){return t&&t.length&&t.length>=+e}function w(t,e){return t&&t.length&&t.length<=+e}function _(t){return t&&t.length==+arg}function O(t,e){return t>=+e}function E(t,e){return t<=+e}function z(t,e){var n=e.match(new RegExp("^/(.*?)/([gimy]*)$")),i=new RegExp(n[1],n[2]);return i.test(t)}function S(t){return function(e){e.preventDefault(),I.validate(e.target,!0)&&t(e)}}function k(e){k.installed||(t(e),e.field=p(e),e.mixin({created:function(){this.$options.components.fields=e.extend(e.field)}}),e.validator=I,e.filter("valid",S),e.directive("validator",P),e.directive("validate",R),e.config.optionMergeStrategies.types=e.config.optionMergeStrategies.props)}var j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},A=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},T=!1,N={},V=Array.isArray,F={name:"field",props:["config"],data:function(){return A({name:"",type:"text",label:"",attrs:{},options:[],default:void 0},this.config)},computed:{key:function(){return'["'+this.name.replace(/\./g,'"]["')+'"]'},value:{get:function(){var t=this.$parent.get(this);return o(t)&&!o(this.default)&&(t=this.default)&&this.$parent.set(this,t),t},set:function(t){o(this.value)&&!t||this.$parent.set(this,t)}}},methods:{filterOptions:function(t){var n=this,o=[];return t?(f(t,function(t,e){i(t)?o.push({label:e,options:n.filterOptions(t)}):o.push({text:e,value:t})}),o):(e("Invalid options provided for "+this.name),o)}},filters:{options:function(t){return this.filterOptions(t)}}},L='<div>\n\n    <div v-for="field in fields">\n        <label v-if="field.type != \'checkbox\'">{{ field.label }}</label>\n        <component :is="field.type" :config="field"></component>\n    </div>\n\n</div>\n',M=Object.freeze({required:c,numeric:v,integer:h,float:m,alpha:y,alphanum:g,email:b,url:x,minlength:$,maxlength:w,length:_,min:O,max:E,pattern:z}),I={dirs:[],types:M,add:function(t){this.dirs.push(t)},remove:function(t){d(this.dirs,t)},instance:function(t){do{if(t._validator)return t._validator;t=t.parentElement}while(t)},validate:function(t,e){var n=this,i=this.instance(t),o={valid:!0};if(i)return this.dirs.forEach(function(t){var a=t.validate(),r=t.el,l=t.name;n.instance(r)===i&&(!r._touched&&e&&(r._touched=!0),r._touched||a||(a=!0,o.valid=!1),o[l]||(o[l]={valid:!0,invalid:!1,dirty:r._dirty,touched:r._touched}),o[l][t.type]=!a,e&&o.valid&&!a&&r.focus(),o[l].valid&&!a&&(o[l].valid=!1,o[l].invalid=!0,o.valid=!1))}),o.invalid=!o.valid,i.results(o),e&&o.invalid&&s(i.el,"invalid"),o.valid}},P={bind:function(){var t=this,e=this.arg||this.expression;this.name=u(e),this.el._validator=this,this.vm.$set(this.name),this.vm.$on("hook:compiled",function(){I.validate(t.el)})},unbind:function(){this.vm.$delete(this.name)},results:function(t){this.vm.$set(this.name,A({validate:this.validate.bind(this)},t))},validate:function(){return I.validate(this.el,!0)}},R={priority:500,bind:function(){var t=l(this.el,"name");t&&(this.name=u(t),this.type=this.arg,this.value=this.el.value,this.el._dirty=!1,this.el._touched=!1,a(this.el,"blur",this.listener.bind(this)),a(this.el,"input",this.listener.bind(this)),I.add(this))},unbind:function(){r(this.el,"blur",this.listener),r(this.el,"input",this.listener),I.remove(this)},update:function(t){this.args=t},listener:function(t){(!t.relatedTarget||"A"!==t.relatedTarget.tagName&&"BUTTON"!==t.relatedTarget.tagName)&&("blur"==t.type&&(this.el._touched=!0),this.el.value!=this.value&&(this.el._dirty=!0),I.validate(this.el))},validate:function(){var t=this.validator();if(t)return t.call(this.vm,this.el.value,this.args)},validator:function(){var t,e=this.vm;do{if(t=e.$options.validators||{},t[this.type])return t[this.type];e=e.$parent}while(e);return I.types[this.type]}};return"undefined"!=typeof window&&window.Vue&&window.Vue.use(k),k});