/*!
 * vue-form v0.1.0
 * Released under the MIT License.
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.VueForm=e()}(this,function(){"use strict";function t(t){j=t.util,V=t.config.debug||!t.config.silent}function e(t){"undefined"!=typeof console&&V&&console.warn("[VueForm warn]: "+t)}function i(t){return"string"==typeof t}function n(t){return null!==t&&"object"===("undefined"==typeof t?"undefined":F(t))}function o(t){return"undefined"==typeof t}function a(t,e,i,n){t.addEventListener(e,i,n)}function l(t,e,i){t.removeEventListener(e,i)}function r(t,e){return t?t.getAttribute(e):null}function s(t,e){var i=document.createEvent("HTMLEvents");i.initEvent(e,!0,!1),t.dispatchEvent(i)}function u(t){return j.camelize(t)}function f(t,e){t.splice(t.indexOf(e),1)}function d(t,e){var i,o;if("number"==typeof t.length)for(i=0;i<t.length;i++)e.call(t[i],t[i],i);else if(n(t))for(o in t)t.hasOwnProperty(o)&&e.call(t[o],t[o],o);return t}function c(t){var a={name:"field",props:["config","values","class"],template:'<partial :name="type"></partial>',data:function(){return T({key:"",name:"",type:"text",label:"",attrs:{},options:[],default:void 0},this.config)},created:function(){this.$set("key",'["'+this.name.replace(/\./g,'"]["')+'"]'),o(this.value)&&!o(this.default)&&(this.value=this.default)},computed:{value:{get:function(){return this.$get("values"+this.key)},set:function(t){this.$set("values"+this.key,t)}}},methods:{filterOptions:function(t){var i=this,o=[];return t?(d(t,function(t,e){n(t)?o.push({label:e,options:i.filterOptions(t)}):o.push({text:e,value:t})}),o):(e("Invalid options provided for "+this.name),o)}},filters:{options:function(t){return this.filterOptions(t)}},partials:{},components:{}};return d(t,function(t,e){i(t)?a.partials[e]=t:n(t)&&(a.partials[e]='<component :is="type" :config="config" :value.sync="value"></component>',a.components[e]=function(e){e(t)})}),a}function p(t){return{name:"fields",props:{config:{default:""},model:{default:""},template:{type:String,default:"default"}},created:function(){return this.fields&&this.values?void(this.$options.template||(this.$options.template=p.templates[this.template])):(e("Invalid config or model provided"),void(this.$options.template=""))},computed:{fields:function(){var t=this;if(n(this.config))return this.filterFields(this.config);do{if(n(t.$options[this.config]))return this.filterFields(t.$options[this.config]);t=t.$parent}while(t)},values:function(){var t=this;if(n(this.model))return this.model;do{if(n(t.$get(this.model)))return t.$get(this.model);t=t.$parent}while(t)}},methods:{filterFields:function(t){var n=this,o=N(t),a=[];return d(t,function(t,l){i(t.name)||o||(t.name=l),i(t.name)?t.show&&!new Vue({data:n.values}).$eval(t.show)||a.push(t):e("Field name missing "+JSON.stringify(t))}),a}},components:{field:c(T(t.fields||{},p.types))}}}function h(t,e){return"boolean"!=typeof e&&(e=!0),"boolean"==typeof t?!e||t:!e||!(null===t||0===t.length)}function v(t){return/^[-+]?[0-9]+$/.test(t)}function m(t){return/^(?:[-+]?(?:0|[1-9][0-9]*))$/.test(t)}function y(t){return/^(?:[-+]?(?:[0-9]+))?(?:\.[0-9]*)?(?:[eE][\+\-]?(?:[0-9]+))?$/.test(t)}function g(t){return/^([A-Z]+)?$/i.test(t)}function b(t){return/^([0-9A-Z]+)?$/i.test(t)}function $(t){return/^([a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*)?$/i.test(t||"a@a.aa")}function x(t){return/^((ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?)?$/.test(t)}function w(t,e){return t&&t.length&&t.length>=+e}function _(t,e){return t&&t.length&&t.length<=+e}function E(t){return t&&t.length==+arg}function O(t,e){return t>=+e}function z(t,e){return t<=+e}function k(t,e){var i=e.match(new RegExp("^/(.*?)/([gimy]*)$")),n=new RegExp(i[1],i[2]);return n.test(t)}function S(t){return function(e){e.preventDefault(),R.validate(e.target,!0)&&t(e)}}function A(e){A.installed||(t(e),e.field=p,e.mixin(I),e.validator=R,e.filter("valid",S),e.directive("validator",Z),e.directive("validate",q))}var F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},T=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},V=!1,j={},N=Array.isArray,L='<div v-for="field in fields">\n    <label v-if="field.type != \'checkbox\'">{{ field.label }}</label>\n    <field :config="field" :values.sync="values"></field>\n</div>\n';p.types={text:'<input type="text" v-bind="attrs" v-model="value">',textarea:'<textarea v-bind="attrs" v-model="value"></textarea>',radio:'<template v-for="option in options | options">\n                    <input type="radio" v-bind="attrs" :name="name" :value="option.value" v-model="value"> <label>{{ option.text }}</label>\n                 </template>',checkbox:'<input type="checkbox" v-bind="attrs" v-model="value">',select:'<select v-bind="attrs" v-model="value">\n                     <template v-for="option in options | options">\n                         <optgroup :label="option.label" v-if="option.label">\n                             <option v-for="opt in option.options" :value="opt.value">{{ opt.text }}</option>\n                         </optgroup>\n                         <option :value="option.value" v-else>{{ option.text }}</option>\n                     </template>\n                 </select>'},p.templates={default:L};var I={created:function(){this.$options.components.fields=Vue.extend(p(this.$options))}},P=Object.freeze({required:h,numeric:v,integer:m,float:y,alpha:g,alphanum:b,email:$,url:x,minlength:w,maxlength:_,length:E,min:O,max:z,pattern:k}),R={dirs:[],types:P,add:function(t){this.dirs.push(t)},remove:function(t){f(this.dirs,t)},instance:function(t){do{if(t._validator)return t._validator;t=t.parentElement}while(t)},validate:function(t,e){var i=this,n=this.instance(t),o={valid:!0};if(n)return this.dirs.forEach(function(t){var a=t.validate(),l=t.el,r=t.name;i.instance(l)===n&&(!l._touched&&e&&(l._touched=!0),l._touched||a||(a=!0,o.valid=!1),o[r]||(o[r]={valid:!0,invalid:!1,dirty:l._dirty,touched:l._touched}),o[r][t.type]=!a,e&&o.valid&&!a&&l.focus(),o[r].valid&&!a&&(o[r].valid=!1,o[r].invalid=!0,o.valid=!1))}),o.invalid=!o.valid,n.results(o),e&&o.invalid&&s(n.el,"invalid"),o.valid}},Z={bind:function(){var t=this,e=this.arg||this.expression;this.name=u(e),this.el._validator=this,this.vm.$set(this.name),this.vm.$on("hook:compiled",function(){R.validate(t.el)})},unbind:function(){this.vm.$delete(this.name)},results:function(t){this.vm.$set(this.name,T({validate:this.validate.bind(this)},t))},validate:function(){return R.validate(this.el,!0)}},q={priority:500,bind:function(){var t=r(this.el,"name");t&&(this.name=u(t),this.type=this.arg,this.value=this.el.value,this.el._dirty=!1,this.el._touched=!1,a(this.el,"blur",this.listener.bind(this)),a(this.el,"input",this.listener.bind(this)),R.add(this))},unbind:function(){l(this.el,"blur",this.listener),l(this.el,"input",this.listener),R.remove(this)},update:function(t){this.args=t},listener:function(t){(!t.relatedTarget||"A"!==t.relatedTarget.tagName&&"BUTTON"!==t.relatedTarget.tagName)&&("blur"==t.type&&(this.el._touched=!0),this.el.value!=this.value&&(this.el._dirty=!0),R.validate(this.el))},validate:function(){var t=this.validator();if(t)return t.call(this.vm,this.el.value,this.args)},validator:function(){var t,e=this.vm;do{if(t=e.$options.validators||{},t[this.type])return t[this.type];e=e.$parent}while(e);return R.types[this.type]}};return"undefined"!=typeof window&&window.Vue&&window.Vue.use(A),A});